<!-- 

   <div class="container">
    <div class="field-selector">
      <h3>בחר שדה למיקום:</h3>
      <ul>
        @for (field of fields; track field) {
          <li>
            @if (!isFieldPlaced(field.field.id)) {
              <button
                [class.selected]="isFieldSelected(field)"
                (click)="selectField(field)">
                {{ field.field.name }}
              </button>
            } @else {
              <button class="edit-button" (click)="editPlacement(field)">
                שנה מיקום {{ field.field.name }}
              </button>
            }
          </li>
        }
      </ul>
    </div>
  
    <div class="image-placement-area">
      @if(showPrompt && selectedField) {
        <div class="placement-prompt">
          <p>אנא לחץ על התמונה במיקום שבו אתה רוצה למקם את השדה "{{ selectedField.field.name }}"</p>
        </div>
      }
  
      <div class="image-container" #imageContainer>
        <img
          #templateImage
          [src]="templateImageUrl"
          alt="Template"
          class="template-image"
          (click)="onImageClick($event)"
        />
        @for (field of fields; track field) {
          @if (positions[field.field.id]) {
            <div
              class="field-label"
              [style.top]="getFieldPosition(field.field.id)?.top"
              [style.left]="getFieldPosition(field.field.id)?.left"
              [style.position]="'absolute'"
              [attr.data-field-id]="field.field.id"
              (mousedown)="startDrag($event, field)"
              style="cursor: grab;"
            >
              {{ field.field.name }}
            </div>
          }
        }
      </div>
    </div>
  </div> -->

<div class="field-placement-container">
<!-- <div class="page-header">
      <h1>מיקום שדות בתבנית</h1>
      <div class="template-info">
      </div>
    </div> -->

<div class="placement-workspace">
    <div class="fields-panel">
        <div class="panel-header">
            <h2>שדות זמינים</h2>
        </div>
        <div class="fields-list">
            @for (field of fields; track field) {
            <div class="field-item" [class.placed]="isFieldPlaced(field.field.id)"
                [class.selected]="isFieldSelected(field)">
                @if (!isFieldPlaced(field.field.id)) {
                <button class="field-button" (click)="selectField(field)">
                    <mat-icon>input</mat-icon>
                    <span>{{ field.field.name }}</span>
                </button>
                } @else {
                <button class="field-button edit-button" (click)="editPlacement(field)">
                    <mat-icon>edit_location</mat-icon>
                    <span>{{ field.field.name }}</span>
                </button>
                }
            </div>
            }
        </div>
    </div>

    <div class="template-workspace">
        @if(showPrompt && selectedField) {
        <div class="placement-prompt">
            <mat-icon>touch_app</mat-icon>
            <p>לחץ על התמונה במיקום שבו אתה רוצה למקם את השדה "{{ selectedField.field.name }}"</p>
        </div>
        }

        <div class="image-container" #imageContainer>
            @if(templateImageUrl) {
            <img #templateImage [src]="templateImageUrl" alt="Template" class="template-image"
                (click)="onImageClick($event)" />
            @for (field of fields; track field) {
            @if (positions[field.field.id]) {
            <div class="field-label" [style.top]="getFieldPosition(field.field.id)?.top"
                [style.left]="getFieldPosition(field.field.id)?.left" [style.position]="'absolute'"
                [attr.data-field-id]="field.field.id" (mousedown)="startDrag($event, field)">
                <div class="field-label-content">
                    <mat-icon>drag_indicator</mat-icon>
                    <span>{{ field.field.name }}</span>
                </div>
            </div>
            }
            }
            } @else {
            <div class="loading-template">
                <mat-spinner diameter="40"></mat-spinner>
                <p>טוען תבנית...</p>
            </div>
            }
        </div>
    </div>
</div>

<!-- <div class="actions-panel">
      <button mat-raised-button color="primary" (click)="saveAllPlacements()">
        <mat-icon>save</mat-icon>
        שמור מיקומים
      </button>
      <button mat-button (click)="goBack()">
        <mat-icon>arrow_back</mat-icon>
        חזור
      </button>
    </div> -->
</div>